//////////////////////////////////////////////////////////////////////
// FastFIR.h: interface for the CFastFIR class.
//
// This class implements a FIR Bandpass filter using a FFT convolution algorithm
// The filter is complex and is specified with 3 parameters:
// sample frequency, Hicut and Lowcut frequency
//
// History:
//	2010-09-15  Initial creation MSW
//	2011-03-27  Initial release
//////////////////////////////////////////////////////////////////////
#ifndef FASTFIR_H
#define FASTFIR_H

#include "datatypes.h"
#include "kiwi.h"
#include <fftw3.h>

#define CONV_FIR_SIZE (CONV_FFT_SIZE/2+1)	//must be <= FFT size. Make 1/2 +1 if want
											//output to be in power of 2

class CFastFIR  
{
public:
	CFastFIR();
	virtual ~CFastFIR();

	void SetupParameters( TYPEREAL FLoCut,TYPEREAL FHiCut,TYPEREAL Offset, TYPEREAL SampleRate);
	int ProcessData(int rx_chan, int InLength, TYPECPX* InBuf, TYPECPX* OutBuf);

private:
	inline void CpxMpy(int N, TYPECPX* m, TYPECPX* src, TYPECPX* dest);

	TYPEREAL m_FLoCut;
	TYPEREAL m_FHiCut;
	TYPEREAL m_Offset;
	TYPEREAL m_SampleRate;

	int m_InBufInPos;
	TYPEREAL m_pWindowTbl[CONV_FIR_SIZE];
	TYPECPX m_pFFTOverlapBuf[CONV_FIR_SIZE];
	TYPECPX m_pFilterCoef[CONV_FFT_SIZE];
	TYPECPX m_pFFTBuf[CONV_FFT_SIZE];
	MFFTW_PLAN m_FFT_CoefPlan;
	MFFTW_PLAN m_FFT_FwdPlan;
	MFFTW_PLAN m_FFT_RevPlan;
};

extern CFastFIR m_PassbandFIR[MAX_RX_CHANS];

const TYPEREAL CIC_compensation[CONV_FFT_SIZE] = {
/*    0 */  1.027408 /* 0.1 dB */, 1.068401 /* 0.3 dB */, 1.107044 /* 0.4 dB */, 1.063501 /* 0.3 dB */, 
/*    4 */  1.041499 /* 0.2 dB */, 1.057273 /* 0.2 dB */, 1.107798 /* 0.4 dB */, 1.101689 /* 0.4 dB */, 
/*    8 */  1.063092 /* 0.3 dB */, 1.036713 /* 0.2 dB */, 1.029991 /* 0.1 dB */, 1.107256 /* 0.4 dB */, 
/*   12 */  1.084595 /* 0.4 dB */, 1.115823 /* 0.5 dB */, 1.014493 /* 0.1 dB */, 1.101587 /* 0.4 dB */, 
/*   16 */  1.107838 /* 0.4 dB */, 1.147115 /* 0.6 dB */, 1.069809 /* 0.3 dB */, 1.121630 /* 0.5 dB */, 
/*   20 */  1.065387 /* 0.3 dB */, 1.093505 /* 0.4 dB */, 1.175266 /* 0.7 dB */, 1.120121 /* 0.5 dB */, 
/*   24 */  1.086923 /* 0.4 dB */, 1.101788 /* 0.4 dB */, 1.083705 /* 0.3 dB */, 1.097970 /* 0.4 dB */, 
/*   28 */  1.075694 /* 0.3 dB */, 1.077689 /* 0.3 dB */, 1.142644 /* 0.6 dB */, 1.107954 /* 0.4 dB */, 
/*   32 */  1.152986 /* 0.6 dB */, 1.042431 /* 0.2 dB */, 1.076474 /* 0.3 dB */, 1.098159 /* 0.4 dB */, 
/*   36 */  1.104324 /* 0.4 dB */, 1.083775 /* 0.3 dB */, 1.094592 /* 0.4 dB */, 1.094954 /* 0.4 dB */, 
/*   40 */  1.091964 /* 0.4 dB */, 1.058648 /* 0.2 dB */, 1.066516 /* 0.3 dB */, 1.129026 /* 0.5 dB */, 
/*   44 */  1.120468 /* 0.5 dB */, 1.122429 /* 0.5 dB */, 1.077592 /* 0.3 dB */, 1.109329 /* 0.5 dB */, 
/*   48 */  1.132690 /* 0.5 dB */, 1.033508 /* 0.1 dB */, 1.123631 /* 0.5 dB */, 1.093067 /* 0.4 dB */, 
/*   52 */  1.059704 /* 0.3 dB */, 1.134182 /* 0.5 dB */, 1.084219 /* 0.4 dB */, 1.137932 /* 0.6 dB */, 
/*   56 */  1.121582 /* 0.5 dB */, 1.151740 /* 0.6 dB */, 1.096449 /* 0.4 dB */, 1.167861 /* 0.7 dB */, 
/*   60 */  1.068243 /* 0.3 dB */, 1.087067 /* 0.4 dB */, 1.059360 /* 0.3 dB */, 1.140128 /* 0.6 dB */, 
/*   64 */  1.098439 /* 0.4 dB */, 1.156654 /* 0.6 dB */, 1.176926 /* 0.7 dB */, 1.039371 /* 0.2 dB */, 
/*   68 */  1.160080 /* 0.6 dB */, 1.171691 /* 0.7 dB */, 1.032546 /* 0.1 dB */, 1.115894 /* 0.5 dB */, 
/*   72 */  1.119615 /* 0.5 dB */, 1.153133 /* 0.6 dB */, 1.146966 /* 0.6 dB */, 1.091272 /* 0.4 dB */, 
/*   76 */  1.216883 /* 0.9 dB */, 1.148833 /* 0.6 dB */, 1.137799 /* 0.6 dB */, 1.175329 /* 0.7 dB */, 
/*   80 */  1.134345 /* 0.5 dB */, 1.140075 /* 0.6 dB */, 1.175274 /* 0.7 dB */, 1.094589 /* 0.4 dB */, 
/*   84 */  1.166979 /* 0.7 dB */, 1.150172 /* 0.6 dB */, 1.161878 /* 0.7 dB */, 1.137108 /* 0.6 dB */, 
/*   88 */  1.145367 /* 0.6 dB */, 1.194111 /* 0.8 dB */, 1.125925 /* 0.5 dB */, 1.206627 /* 0.8 dB */, 
/*   92 */  1.126247 /* 0.5 dB */, 1.120203 /* 0.5 dB */, 1.138901 /* 0.6 dB */, 1.126252 /* 0.5 dB */, 
/*   96 */  1.191267 /* 0.8 dB */, 1.200887 /* 0.8 dB */, 1.148104 /* 0.6 dB */, 1.161108 /* 0.6 dB */, 
/*  100 */  1.182877 /* 0.7 dB */, 1.128579 /* 0.5 dB */, 1.140061 /* 0.6 dB */, 1.137354 /* 0.6 dB */, 
/*  104 */  1.244505 /* 0.9 dB */, 1.257859 /* 1.0 dB */, 1.214629 /* 0.8 dB */, 1.177090 /* 0.7 dB */, 
/*  108 */  1.108176 /* 0.4 dB */, 1.197951 /* 0.8 dB */, 1.220691 /* 0.9 dB */, 1.216852 /* 0.9 dB */, 
/*  112 */  1.210558 /* 0.8 dB */, 1.168478 /* 0.7 dB */, 1.150328 /* 0.6 dB */, 1.225021 /* 0.9 dB */, 
/*  116 */  1.159262 /* 0.6 dB */, 1.175005 /* 0.7 dB */, 1.224604 /* 0.9 dB */, 1.271901 /* 1.0 dB */, 
/*  120 */  1.200367 /* 0.8 dB */, 1.214430 /* 0.8 dB */, 1.228107 /* 0.9 dB */, 1.263533 /* 1.0 dB */, 
/*  124 */  1.208178 /* 0.8 dB */, 1.242090 /* 0.9 dB */, 1.242716 /* 0.9 dB */, 1.249249 /* 1.0 dB */, 
/*  128 */  1.280686 /* 1.1 dB */, 1.233555 /* 0.9 dB */, 1.271020 /* 1.0 dB */, 1.227875 /* 0.9 dB */, 
/*  132 */  1.221045 /* 0.9 dB */, 1.206031 /* 0.8 dB */, 1.325693 /* 1.2 dB */, 1.208501 /* 0.8 dB */, 
/*  136 */  1.217870 /* 0.9 dB */, 1.294544 /* 1.1 dB */, 1.254428 /* 1.0 dB */, 1.253412 /* 1.0 dB */, 
/*  140 */  1.290068 /* 1.1 dB */, 1.288770 /* 1.1 dB */, 1.245583 /* 1.0 dB */, 1.278546 /* 1.1 dB */, 
/*  144 */  1.249426 /* 1.0 dB */, 1.239840 /* 0.9 dB */, 1.320635 /* 1.2 dB */, 1.281862 /* 1.1 dB */, 
/*  148 */  1.287364 /* 1.1 dB */, 1.301221 /* 1.1 dB */, 1.329047 /* 1.2 dB */, 1.285989 /* 1.1 dB */, 
/*  152 */  1.368826 /* 1.4 dB */, 1.288304 /* 1.1 dB */, 1.256213 /* 1.0 dB */, 1.359836 /* 1.3 dB */, 
/*  156 */  1.325284 /* 1.2 dB */, 1.271323 /* 1.0 dB */, 1.302613 /* 1.1 dB */, 1.290587 /* 1.1 dB */, 
/*  160 */  1.321329 /* 1.2 dB */, 1.350827 /* 1.3 dB */, 1.303738 /* 1.2 dB */, 1.367648 /* 1.4 dB */, 
/*  164 */  1.354103 /* 1.3 dB */, 1.378989 /* 1.4 dB */, 1.398952 /* 1.5 dB */, 1.396914 /* 1.5 dB */, 
/*  168 */  1.339254 /* 1.3 dB */, 1.354076 /* 1.3 dB */, 1.365218 /* 1.4 dB */, 1.356938 /* 1.3 dB */, 
/*  172 */  1.292481 /* 1.1 dB */, 1.364327 /* 1.3 dB */, 1.444060 /* 1.6 dB */, 1.408602 /* 1.5 dB */, 
/*  176 */  1.434868 /* 1.6 dB */, 1.375006 /* 1.4 dB */, 1.381271 /* 1.4 dB */, 1.411641 /* 1.5 dB */, 
/*  180 */  1.287064 /* 1.1 dB */, 1.421894 /* 1.5 dB */, 1.454235 /* 1.6 dB */, 1.436907 /* 1.6 dB */, 
/*  184 */  1.403836 /* 1.5 dB */, 1.408971 /* 1.5 dB */, 1.444756 /* 1.6 dB */, 1.464623 /* 1.7 dB */, 
/*  188 */  1.448639 /* 1.6 dB */, 1.435375 /* 1.6 dB */, 1.421905 /* 1.5 dB */, 1.543938 /* 1.9 dB */, 
/*  192 */  1.365478 /* 1.4 dB */, 1.486153 /* 1.7 dB */, 1.460974 /* 1.6 dB */, 1.456033 /* 1.6 dB */, 
/*  196 */  1.514995 /* 1.8 dB */, 1.440504 /* 1.6 dB */, 1.493297 /* 1.7 dB */, 1.460328 /* 1.6 dB */, 
/*  200 */  1.466344 /* 1.7 dB */, 1.485331 /* 1.7 dB */, 1.460209 /* 1.6 dB */, 1.425129 /* 1.5 dB */, 
/*  204 */  1.435169 /* 1.6 dB */, 1.523175 /* 1.8 dB */, 1.549304 /* 1.9 dB */, 1.531429 /* 1.9 dB */, 
/*  208 */  1.570600 /* 2.0 dB */, 1.572554 /* 2.0 dB */, 1.563513 /* 1.9 dB */, 1.630849 /* 2.1 dB */, 
/*  212 */  1.670651 /* 2.2 dB */, 1.595078 /* 2.0 dB */, 1.585351 /* 2.0 dB */, 1.581490 /* 2.0 dB */, 
/*  216 */  1.558334 /* 1.9 dB */, 1.580967 /* 2.0 dB */, 1.585531 /* 2.0 dB */, 1.594130 /* 2.0 dB */, 
/*  220 */  1.513219 /* 1.8 dB */, 1.519248 /* 1.8 dB */, 1.603982 /* 2.1 dB */, 1.542589 /* 1.9 dB */, 
/*  224 */  1.561282 /* 1.9 dB */, 1.529892 /* 1.8 dB */, 1.648208 /* 2.2 dB */, 1.604448 /* 2.1 dB */, 
/*  228 */  1.648679 /* 2.2 dB */, 1.732766 /* 2.4 dB */, 1.622607 /* 2.1 dB */, 1.552656 /* 1.9 dB */, 
/*  232 */  1.718133 /* 2.4 dB */, 1.679598 /* 2.3 dB */, 1.765441 /* 2.5 dB */, 1.629540 /* 2.1 dB */, 
/*  236 */  1.743877 /* 2.4 dB */, 1.705238 /* 2.3 dB */, 1.761409 /* 2.5 dB */, 1.679800 /* 2.3 dB */, 
/*  240 */  1.663508 /* 2.2 dB */, 1.719400 /* 2.4 dB */, 1.651469 /* 2.2 dB */, 1.704952 /* 2.3 dB */, 
/*  244 */  1.894469 /* 2.8 dB */, 1.739631 /* 2.4 dB */, 1.853367 /* 2.7 dB */, 1.705764 /* 2.3 dB */, 
/*  248 */  1.711273 /* 2.3 dB */, 1.739323 /* 2.4 dB */, 1.729854 /* 2.4 dB */, 1.781369 /* 2.5 dB */, 
/*  252 */  1.798910 /* 2.6 dB */, 1.800039 /* 2.6 dB */, 1.845823 /* 2.7 dB */, 1.749259 /* 2.4 dB */, 
/*  256 */  1.811185 /* 2.6 dB */, 1.894023 /* 2.8 dB */, 1.791330 /* 2.5 dB */, 1.783082 /* 2.5 dB */, 
/*  260 */  1.895885 /* 2.8 dB */, 1.836369 /* 2.6 dB */, 1.891985 /* 2.8 dB */, 1.878623 /* 2.7 dB */, 
/*  264 */  1.881904 /* 2.7 dB */, 1.865067 /* 2.7 dB */, 2.014498 /* 3.0 dB */, 2.063846 /* 3.1 dB */, 
/*  268 */  1.997389 /* 3.0 dB */, 2.083514 /* 3.2 dB */, 1.964749 /* 2.9 dB */, 2.098770 /* 3.2 dB */, 
/*  272 */  1.990328 /* 3.0 dB */, 1.971560 /* 2.9 dB */, 1.920077 /* 2.8 dB */, 2.074044 /* 3.2 dB */, 
/*  276 */  2.055208 /* 3.1 dB */, 1.968084 /* 2.9 dB */, 2.036193 /* 3.1 dB */, 2.073086 /* 3.2 dB */, 
/*  280 */  2.144350 /* 3.3 dB */, 2.043862 /* 3.1 dB */, 1.983333 /* 3.0 dB */, 2.086245 /* 3.2 dB */, 
/*  284 */  2.091996 /* 3.2 dB */, 2.187991 /* 3.4 dB */, 2.078293 /* 3.2 dB */, 2.112387 /* 3.2 dB */, 
/*  288 */  2.022178 /* 3.1 dB */, 2.056194 /* 3.1 dB */, 2.076202 /* 3.2 dB */, 2.112909 /* 3.2 dB */, 
/*  292 */  2.097901 /* 3.2 dB */, 2.188880 /* 3.4 dB */, 2.229879 /* 3.5 dB */, 2.154605 /* 3.3 dB */, 
/*  296 */  2.185296 /* 3.4 dB */, 2.228934 /* 3.5 dB */, 2.119673 /* 3.3 dB */, 2.262485 /* 3.5 dB */, 
/*  300 */  2.227027 /* 3.5 dB */, 2.184916 /* 3.4 dB */, 2.246010 /* 3.5 dB */, 2.335638 /* 3.7 dB */, 
/*  304 */  2.251309 /* 3.5 dB */, 2.190655 /* 3.4 dB */, 2.209078 /* 3.4 dB */, 2.187196 /* 3.4 dB */, 
/*  308 */  2.290578 /* 3.6 dB */, 2.404037 /* 3.8 dB */, 2.380842 /* 3.8 dB */, 2.375572 /* 3.8 dB */, 
/*  312 */  2.367556 /* 3.7 dB */, 2.429758 /* 3.9 dB */, 2.488075 /* 4.0 dB */, 2.306879 /* 3.6 dB */, 
/*  316 */  2.391988 /* 3.8 dB */, 2.512948 /* 4.0 dB */, 2.434178 /* 3.9 dB */, 2.466393 /* 3.9 dB */, 
/*  320 */  2.521346 /* 4.0 dB */, 2.560241 /* 4.1 dB */, 2.720121 /* 4.3 dB */, 2.495061 /* 4.0 dB */, 
/*  324 */  2.652416 /* 4.2 dB */, 2.521641 /* 4.0 dB */, 2.477813 /* 3.9 dB */, 2.624025 /* 4.2 dB */, 
/*  328 */  2.528729 /* 4.0 dB */, 2.463148 /* 3.9 dB */, 2.579487 /* 4.1 dB */, 2.673907 /* 4.3 dB */, 
/*  332 */  2.439449 /* 3.9 dB */, 2.668347 /* 4.3 dB */, 2.694230 /* 4.3 dB */, 2.892896 /* 4.6 dB */, 
/*  336 */  2.698007 /* 4.3 dB */, 2.743039 /* 4.4 dB */, 2.858495 /* 4.6 dB */, 2.771293 /* 4.4 dB */, 
/*  340 */  2.770888 /* 4.4 dB */, 3.075753 /* 4.9 dB */, 2.730052 /* 4.4 dB */, 2.764577 /* 4.4 dB */, 
/*  344 */  2.862861 /* 4.6 dB */, 2.849060 /* 4.5 dB */, 2.743571 /* 4.4 dB */, 2.871329 /* 4.6 dB */, 
/*  348 */  2.969182 /* 4.7 dB */, 2.803178 /* 4.5 dB */, 2.834399 /* 4.5 dB */, 2.923277 /* 4.7 dB */, 
/*  352 */  3.003350 /* 4.8 dB */, 2.921318 /* 4.7 dB */, 2.935367 /* 4.7 dB */, 2.819746 /* 4.5 dB */, 
/*  356 */  2.909790 /* 4.6 dB */, 3.201825 /* 5.1 dB */, 3.169685 /* 5.0 dB */, 3.145589 /* 5.0 dB */, 
/*  360 */  3.105801 /* 4.9 dB */, 3.115088 /* 4.9 dB */, 3.124792 /* 4.9 dB */, 3.204262 /* 5.1 dB */, 
/*  364 */  3.227388 /* 5.1 dB */, 3.148587 /* 5.0 dB */, 3.200239 /* 5.1 dB */, 3.081208 /* 4.9 dB */, 
/*  368 */  3.572776 /* 5.5 dB */, 3.237631 /* 5.1 dB */, 3.366040 /* 5.3 dB */, 3.464508 /* 5.4 dB */, 
/*  372 */  3.325029 /* 5.2 dB */, 3.190611 /* 5.0 dB */, 3.453640 /* 5.4 dB */, 3.387551 /* 5.3 dB */, 
/*  376 */  3.291149 /* 5.2 dB */, 3.606768 /* 5.6 dB */, 3.405396 /* 5.3 dB */, 3.295969 /* 5.2 dB */, 
/*  380 */  3.684960 /* 5.7 dB */, 3.613037 /* 5.6 dB */, 3.731881 /* 5.7 dB */, 3.905104 /* 5.9 dB */, 
/*  384 */  3.688554 /* 5.7 dB */, 3.612017 /* 5.6 dB */, 3.588410 /* 5.5 dB */, 3.747027 /* 5.7 dB */, 
/*  388 */  3.588254 /* 5.5 dB */, 3.765121 /* 5.8 dB */, 3.704515 /* 5.7 dB */, 3.724876 /* 5.7 dB */, 
/*  392 */  3.824256 /* 5.8 dB */, 3.730403 /* 5.7 dB */, 3.812693 /* 5.8 dB */, 3.738445 /* 5.7 dB */, 
/*  396 */  3.761627 /* 5.8 dB */, 3.773571 /* 5.8 dB */, 3.622263 /* 5.6 dB */, 3.945442 /* 6.0 dB */, 
/*  400 */  3.934843 /* 5.9 dB */, 4.203899 /* 6.2 dB */, 3.994882 /* 6.0 dB */, 3.938012 /* 6.0 dB */, 
/*  404 */  3.975105 /* 6.0 dB */, 4.008435 /* 6.0 dB */, 4.228647 /* 6.3 dB */, 4.389297 /* 6.4 dB */, 
/*  408 */  3.986965 /* 6.0 dB */, 4.397975 /* 6.4 dB */, 4.567848 /* 6.6 dB */, 4.379900 /* 6.4 dB */, 
/*  412 */  4.401540 /* 6.4 dB */, 4.251526 /* 6.3 dB */, 4.462502 /* 6.5 dB */, 4.440041 /* 6.5 dB */, 
/*  416 */  4.559258 /* 6.6 dB */, 4.345258 /* 6.4 dB */, 4.471637 /* 6.5 dB */, 4.550964 /* 6.6 dB */, 
/*  420 */  4.682400 /* 6.7 dB */, 4.743528 /* 6.8 dB */, 4.612950 /* 6.6 dB */, 4.641456 /* 6.7 dB */, 
/*  424 */  4.714174 /* 6.7 dB */, 4.826595 /* 6.8 dB */, 4.668948 /* 6.7 dB */, 4.725835 /* 6.7 dB */, 
/*  428 */  4.684342 /* 6.7 dB */, 4.838861 /* 6.8 dB */, 4.937469 /* 6.9 dB */, 5.223602 /* 7.2 dB */, 
/*  432 */  4.892982 /* 6.9 dB */, 4.869806 /* 6.9 dB */, 5.005049 /* 7.0 dB */, 4.918440 /* 6.9 dB */, 
/*  436 */  5.135796 /* 7.1 dB */, 5.105897 /* 7.1 dB */, 5.193408 /* 7.2 dB */, 5.236828 /* 7.2 dB */, 
/*  440 */  5.037900 /* 7.0 dB */, 5.396909 /* 7.3 dB */, 5.476077 /* 7.4 dB */, 5.396857 /* 7.3 dB */, 
/*  444 */  5.453957 /* 7.4 dB */, 5.837575 /* 7.7 dB */, 5.590821 /* 7.5 dB */, 5.608883 /* 7.5 dB */, 
/*  448 */  5.428359 /* 7.3 dB */, 5.313162 /* 7.3 dB */, 5.514014 /* 7.4 dB */, 5.593238 /* 7.5 dB */, 
/*  452 */  5.833639 /* 7.7 dB */, 5.880553 /* 7.7 dB */, 5.604027 /* 7.5 dB */, 5.622660 /* 7.5 dB */, 
/*  456 */  6.243398 /* 8.0 dB */, 6.227548 /* 7.9 dB */, 5.495891 /* 7.4 dB */, 5.979049 /* 7.8 dB */, 
/*  460 */  5.670671 /* 7.5 dB */, 5.919176 /* 7.7 dB */, 5.864557 /* 7.7 dB */, 6.122107 /* 7.9 dB */, 
/*  464 */  5.986238 /* 7.8 dB */, 6.087504 /* 7.8 dB */, 6.392045 /* 8.1 dB */, 6.469662 /* 8.1 dB */, 
/*  468 */  6.421872 /* 8.1 dB */, 6.600123 /* 8.2 dB */, 6.123666 /* 7.9 dB */, 6.932617 /* 8.4 dB */, 
/*  472 */  6.127998 /* 7.9 dB */, 6.378668 /* 8.0 dB */, 6.443371 /* 8.1 dB */, 6.576212 /* 8.2 dB */, 
/*  476 */  6.265196 /* 8.0 dB */, 6.279162 /* 8.0 dB */, 6.324602 /* 8.0 dB */, 6.635657 /* 8.2 dB */, 
/*  480 */  6.609347 /* 8.2 dB */, 6.853796 /* 8.4 dB */, 6.788681 /* 8.3 dB */, 6.816938 /* 8.3 dB */, 
/*  484 */  6.933658 /* 8.4 dB */, 6.525439 /* 8.1 dB */, 6.608076 /* 8.2 dB */, 6.766624 /* 8.3 dB */, 
/*  488 */  6.951086 /* 8.4 dB */, 6.755501 /* 8.3 dB */, 7.008304 /* 8.5 dB */, 7.110590 /* 8.5 dB */, 
/*  492 */  7.167144 /* 8.6 dB */, 7.160612 /* 8.5 dB */, 6.542519 /* 8.2 dB */, 6.903012 /* 8.4 dB */, 
/*  496 */  6.730920 /* 8.3 dB */, 6.991942 /* 8.4 dB */, 7.018221 /* 8.5 dB */, 7.278733 /* 8.6 dB */, 
/*  500 */  7.505628 /* 8.8 dB */, 7.141981 /* 8.5 dB */, 7.046531 /* 8.5 dB */, 7.700861 /* 8.9 dB */, 
/*  504 */  7.148584 /* 8.5 dB */, 6.821790 /* 8.3 dB */, 7.290115 /* 8.6 dB */, 7.354832 /* 8.7 dB */, 
/*  508 */  7.334272 /* 8.7 dB */, 7.008458 /* 8.5 dB */, 7.410893 /* 8.7 dB */, 7.103505 /* 8.5 dB */, 
/*  512 */  8.235241 /* 9.2 dB */, 7.553630 /* 8.8 dB */, 7.512956 /* 8.8 dB */, 6.638089 /* 8.2 dB */, 
/*  516 */  7.176019 /* 8.6 dB */, 6.938660 /* 8.4 dB */, 7.060874 /* 8.5 dB */, 7.052587 /* 8.5 dB */, 
/*  520 */  7.323644 /* 8.6 dB */, 6.695929 /* 8.3 dB */, 6.862459 /* 8.4 dB */, 7.177873 /* 8.6 dB */, 
/*  524 */  6.851293 /* 8.4 dB */, 7.215713 /* 8.6 dB */, 7.091373 /* 8.5 dB */, 6.786272 /* 8.3 dB */, 
/*  528 */  7.247002 /* 8.6 dB */, 7.484080 /* 8.7 dB */, 6.716038 /* 8.3 dB */, 6.753703 /* 8.3 dB */, 
/*  532 */  6.749558 /* 8.3 dB */, 6.910098 /* 8.4 dB */, 6.772921 /* 8.3 dB */, 6.931082 /* 8.4 dB */, 
/*  536 */  6.818160 /* 8.3 dB */, 6.835177 /* 8.3 dB */, 7.093460 /* 8.5 dB */, 7.101564 /* 8.5 dB */, 
/*  540 */  6.827299 /* 8.3 dB */, 6.555940 /* 8.2 dB */, 6.852713 /* 8.4 dB */, 6.595365 /* 8.2 dB */, 
/*  544 */  6.943806 /* 8.4 dB */, 6.683694 /* 8.3 dB */, 6.509879 /* 8.1 dB */, 6.490529 /* 8.1 dB */, 
/*  548 */  6.662892 /* 8.2 dB */, 6.505700 /* 8.1 dB */, 6.521279 /* 8.1 dB */, 6.450982 /* 8.1 dB */, 
/*  552 */  6.247765 /* 8.0 dB */, 6.222993 /* 7.9 dB */, 6.201428 /* 7.9 dB */, 6.282726 /* 8.0 dB */, 
/*  556 */  6.299426 /* 8.0 dB */, 6.149021 /* 7.9 dB */, 6.284603 /* 8.0 dB */, 6.098395 /* 7.9 dB */, 
/*  560 */  6.166015 /* 7.9 dB */, 6.146089 /* 7.9 dB */, 6.223660 /* 7.9 dB */, 6.238766 /* 8.0 dB */, 
/*  564 */  6.247611 /* 8.0 dB */, 5.979548 /* 7.8 dB */, 5.871603 /* 7.7 dB */, 6.134245 /* 7.9 dB */, 
/*  568 */  6.069682 /* 7.8 dB */, 5.836745 /* 7.7 dB */, 5.579999 /* 7.5 dB */, 6.115018 /* 7.9 dB */, 
/*  572 */  5.412110 /* 7.3 dB */, 5.922385 /* 7.7 dB */, 5.625051 /* 7.5 dB */, 5.487290 /* 7.4 dB */, 
/*  576 */  5.553263 /* 7.4 dB */, 5.549640 /* 7.4 dB */, 5.360601 /* 7.3 dB */, 5.417870 /* 7.3 dB */, 
/*  580 */  5.457853 /* 7.4 dB */, 5.245460 /* 7.2 dB */, 5.389642 /* 7.3 dB */, 5.131683 /* 7.1 dB */, 
/*  584 */  4.857950 /* 6.9 dB */, 5.263303 /* 7.2 dB */, 5.036729 /* 7.0 dB */, 5.062904 /* 7.0 dB */, 
/*  588 */  5.249899 /* 7.2 dB */, 4.912801 /* 6.9 dB */, 4.698627 /* 6.7 dB */, 4.814280 /* 6.8 dB */, 
/*  592 */  5.039221 /* 7.0 dB */, 5.007320 /* 7.0 dB */, 4.893372 /* 6.9 dB */, 5.004607 /* 7.0 dB */, 
/*  596 */  4.807483 /* 6.8 dB */, 4.456921 /* 6.5 dB */, 4.674157 /* 6.7 dB */, 4.760755 /* 6.8 dB */, 
/*  600 */  4.938420 /* 6.9 dB */, 5.053347 /* 7.0 dB */, 4.620325 /* 6.6 dB */, 4.690067 /* 6.7 dB */, 
/*  604 */  4.765443 /* 6.8 dB */, 4.473047 /* 6.5 dB */, 4.401200 /* 6.4 dB */, 4.313486 /* 6.3 dB */, 
/*  608 */  4.505328 /* 6.5 dB */, 4.327225 /* 6.4 dB */, 4.329767 /* 6.4 dB */, 4.478846 /* 6.5 dB */, 
/*  612 */  4.027272 /* 6.1 dB */, 4.240025 /* 6.3 dB */, 4.199647 /* 6.2 dB */, 4.320191 /* 6.4 dB */, 
/*  616 */  4.379491 /* 6.4 dB */, 4.156065 /* 6.2 dB */, 4.098718 /* 6.1 dB */, 4.283995 /* 6.3 dB */, 
/*  620 */  4.344283 /* 6.4 dB */, 4.069953 /* 6.1 dB */, 4.145147 /* 6.2 dB */, 3.969544 /* 6.0 dB */, 
/*  624 */  3.965045 /* 6.0 dB */, 4.081497 /* 6.1 dB */, 4.092706 /* 6.1 dB */, 4.030505 /* 6.1 dB */, 
/*  628 */  3.890666 /* 5.9 dB */, 4.079283 /* 6.1 dB */, 4.025815 /* 6.0 dB */, 3.825533 /* 5.8 dB */, 
/*  632 */  3.942929 /* 6.0 dB */, 3.842433 /* 5.8 dB */, 3.870029 /* 5.9 dB */, 3.847308 /* 5.9 dB */, 
/*  636 */  3.628200 /* 5.6 dB */, 3.788388 /* 5.8 dB */, 3.577655 /* 5.5 dB */, 3.700627 /* 5.7 dB */, 
/*  640 */  3.718229 /* 5.7 dB */, 3.619601 /* 5.6 dB */, 3.328432 /* 5.2 dB */, 3.439271 /* 5.4 dB */, 
/*  644 */  3.606914 /* 5.6 dB */, 3.426602 /* 5.3 dB */, 3.586543 /* 5.5 dB */, 3.624688 /* 5.6 dB */, 
/*  648 */  3.379052 /* 5.3 dB */, 3.560813 /* 5.5 dB */, 3.417209 /* 5.3 dB */, 3.315330 /* 5.2 dB */, 
/*  652 */  3.307296 /* 5.2 dB */, 3.381077 /* 5.3 dB */, 3.422426 /* 5.3 dB */, 3.394782 /* 5.3 dB */, 
/*  656 */  3.139743 /* 5.0 dB */, 3.173217 /* 5.0 dB */, 3.344141 /* 5.2 dB */, 3.362622 /* 5.3 dB */, 
/*  660 */  3.301174 /* 5.2 dB */, 3.110826 /* 4.9 dB */, 3.160066 /* 5.0 dB */, 3.142695 /* 5.0 dB */, 
/*  664 */  3.011485 /* 4.8 dB */, 2.883312 /* 4.6 dB */, 3.077714 /* 4.9 dB */, 2.904613 /* 4.6 dB */, 
/*  668 */  2.976876 /* 4.7 dB */, 3.055371 /* 4.9 dB */, 3.171850 /* 5.0 dB */, 3.089177 /* 4.9 dB */, 
/*  672 */  3.041303 /* 4.8 dB */, 2.954914 /* 4.7 dB */, 2.778162 /* 4.4 dB */, 2.845055 /* 4.5 dB */, 
/*  676 */  2.885149 /* 4.6 dB */, 2.906206 /* 4.6 dB */, 2.837739 /* 4.5 dB */, 2.869857 /* 4.6 dB */, 
/*  680 */  2.796232 /* 4.5 dB */, 2.735777 /* 4.4 dB */, 2.956503 /* 4.7 dB */, 2.810988 /* 4.5 dB */, 
/*  684 */  2.817944 /* 4.5 dB */, 2.995147 /* 4.8 dB */, 2.785630 /* 4.4 dB */, 2.812475 /* 4.5 dB */, 
/*  688 */  2.731813 /* 4.4 dB */, 2.603106 /* 4.2 dB */, 2.683347 /* 4.3 dB */, 2.660589 /* 4.2 dB */, 
/*  692 */  2.672113 /* 4.3 dB */, 2.609115 /* 4.2 dB */, 2.510188 /* 4.0 dB */, 2.596989 /* 4.1 dB */, 
/*  696 */  2.750168 /* 4.4 dB */, 2.494924 /* 4.0 dB */, 2.536059 /* 4.0 dB */, 2.561185 /* 4.1 dB */, 
/*  700 */  2.483478 /* 4.0 dB */, 2.367747 /* 3.7 dB */, 2.515482 /* 4.0 dB */, 2.653222 /* 4.2 dB */, 
/*  704 */  2.468282 /* 3.9 dB */, 2.529901 /* 4.0 dB */, 2.461649 /* 3.9 dB */, 2.374987 /* 3.8 dB */, 
/*  708 */  2.440213 /* 3.9 dB */, 2.371912 /* 3.8 dB */, 2.362983 /* 3.7 dB */, 2.483949 /* 4.0 dB */, 
/*  712 */  2.306262 /* 3.6 dB */, 2.221511 /* 3.5 dB */, 2.242382 /* 3.5 dB */, 2.387769 /* 3.8 dB */, 
/*  716 */  2.248776 /* 3.5 dB */, 2.244779 /* 3.5 dB */, 2.397063 /* 3.8 dB */, 2.200712 /* 3.4 dB */, 
/*  720 */  2.418386 /* 3.8 dB */, 2.268441 /* 3.6 dB */, 2.388326 /* 3.8 dB */, 2.182303 /* 3.4 dB */, 
/*  724 */  2.199333 /* 3.4 dB */, 2.218210 /* 3.5 dB */, 2.146293 /* 3.3 dB */, 2.201525 /* 3.4 dB */, 
/*  728 */  2.199940 /* 3.4 dB */, 2.109002 /* 3.2 dB */, 2.053260 /* 3.1 dB */, 2.123264 /* 3.3 dB */, 
/*  732 */  2.141184 /* 3.3 dB */, 2.108866 /* 3.2 dB */, 2.239737 /* 3.5 dB */, 2.196463 /* 3.4 dB */, 
/*  736 */  2.121452 /* 3.3 dB */, 2.069543 /* 3.2 dB */, 2.151773 /* 3.3 dB */, 2.044790 /* 3.1 dB */, 
/*  740 */  1.970355 /* 2.9 dB */, 2.102282 /* 3.2 dB */, 2.066832 /* 3.2 dB */, 2.017040 /* 3.0 dB */, 
/*  744 */  1.905811 /* 2.8 dB */, 2.074595 /* 3.2 dB */, 1.983592 /* 3.0 dB */, 2.018575 /* 3.1 dB */, 
/*  748 */  2.073118 /* 3.2 dB */, 2.056475 /* 3.1 dB */, 1.897154 /* 2.8 dB */, 2.038791 /* 3.1 dB */, 
/*  752 */  2.036344 /* 3.1 dB */, 1.972310 /* 2.9 dB */, 2.070807 /* 3.2 dB */, 1.965291 /* 2.9 dB */, 
/*  756 */  1.934505 /* 2.9 dB */, 1.871786 /* 2.7 dB */, 1.904480 /* 2.8 dB */, 1.967984 /* 2.9 dB */, 
/*  760 */  1.938802 /* 2.9 dB */, 1.859810 /* 2.7 dB */, 1.863685 /* 2.7 dB */, 1.819661 /* 2.6 dB */, 
/*  764 */  1.941619 /* 2.9 dB */, 1.834010 /* 2.6 dB */, 1.938759 /* 2.9 dB */, 1.807949 /* 2.6 dB */, 
/*  768 */  1.855584 /* 2.7 dB */, 1.773404 /* 2.5 dB */, 1.754217 /* 2.4 dB */, 1.752317 /* 2.4 dB */, 
/*  772 */  1.704805 /* 2.3 dB */, 1.750303 /* 2.4 dB */, 1.830914 /* 2.6 dB */, 1.845785 /* 2.7 dB */, 
/*  776 */  1.655381 /* 2.2 dB */, 1.747242 /* 2.4 dB */, 1.839157 /* 2.6 dB */, 1.764620 /* 2.5 dB */, 
/*  780 */  1.694034 /* 2.3 dB */, 1.766855 /* 2.5 dB */, 1.686303 /* 2.3 dB */, 1.765779 /* 2.5 dB */, 
/*  784 */  1.705829 /* 2.3 dB */, 1.698451 /* 2.3 dB */, 1.710299 /* 2.3 dB */, 1.647893 /* 2.2 dB */, 
/*  788 */  1.707957 /* 2.3 dB */, 1.654143 /* 2.2 dB */, 1.738253 /* 2.4 dB */, 1.683008 /* 2.3 dB */, 
/*  792 */  1.690221 /* 2.3 dB */, 1.705368 /* 2.3 dB */, 1.593853 /* 2.0 dB */, 1.543897 /* 1.9 dB */, 
/*  796 */  1.618103 /* 2.1 dB */, 1.682037 /* 2.3 dB */, 1.676463 /* 2.2 dB */, 1.606406 /* 2.1 dB */, 
/*  800 */  1.540392 /* 1.9 dB */, 1.582806 /* 2.0 dB */, 1.677489 /* 2.2 dB */, 1.621725 /* 2.1 dB */, 
/*  804 */  1.528880 /* 1.8 dB */, 1.617830 /* 2.1 dB */, 1.567960 /* 2.0 dB */, 1.546103 /* 1.9 dB */, 
/*  808 */  1.633430 /* 2.1 dB */, 1.572075 /* 2.0 dB */, 1.639430 /* 2.1 dB */, 1.565766 /* 1.9 dB */, 
/*  812 */  1.601904 /* 2.0 dB */, 1.543397 /* 1.9 dB */, 1.512406 /* 1.8 dB */, 1.546693 /* 1.9 dB */, 
/*  816 */  1.434651 /* 1.6 dB */, 1.531061 /* 1.8 dB */, 1.537281 /* 1.9 dB */, 1.503448 /* 1.8 dB */, 
/*  820 */  1.567987 /* 2.0 dB */, 1.470497 /* 1.7 dB */, 1.580749 /* 2.0 dB */, 1.520531 /* 1.8 dB */, 
/*  824 */  1.497269 /* 1.8 dB */, 1.509990 /* 1.8 dB */, 1.419427 /* 1.5 dB */, 1.475602 /* 1.7 dB */, 
/*  828 */  1.522973 /* 1.8 dB */, 1.467548 /* 1.7 dB */, 1.433149 /* 1.6 dB */, 1.502059 /* 1.8 dB */, 
/*  832 */  1.434099 /* 1.6 dB */, 1.368405 /* 1.4 dB */, 1.465832 /* 1.7 dB */, 1.435280 /* 1.6 dB */, 
/*  836 */  1.449261 /* 1.6 dB */, 1.434327 /* 1.6 dB */, 1.383589 /* 1.4 dB */, 1.389259 /* 1.4 dB */, 
/*  840 */  1.353277 /* 1.3 dB */, 1.370331 /* 1.4 dB */, 1.501088 /* 1.8 dB */, 1.316330 /* 1.2 dB */, 
/*  844 */  1.341446 /* 1.3 dB */, 1.376178 /* 1.4 dB */, 1.276023 /* 1.1 dB */, 1.410437 /* 1.5 dB */, 
/*  848 */  1.357471 /* 1.3 dB */, 1.349736 /* 1.3 dB */, 1.368705 /* 1.4 dB */, 1.482088 /* 1.7 dB */, 
/*  852 */  1.411754 /* 1.5 dB */, 1.417373 /* 1.5 dB */, 1.319506 /* 1.2 dB */, 1.479185 /* 1.7 dB */, 
/*  856 */  1.376791 /* 1.4 dB */, 1.404925 /* 1.5 dB */, 1.329466 /* 1.2 dB */, 1.295971 /* 1.1 dB */, 
/*  860 */  1.363860 /* 1.3 dB */, 1.338728 /* 1.3 dB */, 1.382961 /* 1.4 dB */, 1.341534 /* 1.3 dB */, 
/*  864 */  1.294567 /* 1.1 dB */, 1.329799 /* 1.2 dB */, 1.375660 /* 1.4 dB */, 1.356149 /* 1.3 dB */, 
/*  868 */  1.347184 /* 1.3 dB */, 1.300884 /* 1.1 dB */, 1.291877 /* 1.1 dB */, 1.256991 /* 1.0 dB */, 
/*  872 */  1.205485 /* 0.8 dB */, 1.296285 /* 1.1 dB */, 1.278315 /* 1.1 dB */, 1.309539 /* 1.2 dB */, 
/*  876 */  1.308652 /* 1.2 dB */, 1.220420 /* 0.9 dB */, 1.267771 /* 1.0 dB */, 1.260357 /* 1.0 dB */, 
/*  880 */  1.279440 /* 1.1 dB */, 1.296808 /* 1.1 dB */, 1.261506 /* 1.0 dB */, 1.298335 /* 1.1 dB */, 
/*  884 */  1.204042 /* 0.8 dB */, 1.286204 /* 1.1 dB */, 1.301175 /* 1.1 dB */, 1.269027 /* 1.0 dB */, 
/*  888 */  1.284993 /* 1.1 dB */, 1.205591 /* 0.8 dB */, 1.167717 /* 0.7 dB */, 1.249270 /* 1.0 dB */, 
/*  892 */  1.319939 /* 1.2 dB */, 1.287939 /* 1.1 dB */, 1.219113 /* 0.9 dB */, 1.202037 /* 0.8 dB */, 
/*  896 */  1.131362 /* 0.5 dB */, 1.175359 /* 0.7 dB */, 1.235984 /* 0.9 dB */, 1.198351 /* 0.8 dB */, 
/*  900 */  1.242133 /* 0.9 dB */, 1.267314 /* 1.0 dB */, 1.164187 /* 0.7 dB */, 1.154507 /* 0.6 dB */, 
/*  904 */  1.176594 /* 0.7 dB */, 1.233033 /* 0.9 dB */, 1.240190 /* 0.9 dB */, 1.252607 /* 1.0 dB */, 
/*  908 */  1.178957 /* 0.7 dB */, 1.200435 /* 0.8 dB */, 1.234733 /* 0.9 dB */, 1.214145 /* 0.8 dB */, 
/*  912 */  1.166680 /* 0.7 dB */, 1.133688 /* 0.5 dB */, 1.187245 /* 0.7 dB */, 1.172692 /* 0.7 dB */, 
/*  916 */  1.202761 /* 0.8 dB */, 1.203850 /* 0.8 dB */, 1.137834 /* 0.6 dB */, 1.189031 /* 0.8 dB */, 
/*  920 */  1.193111 /* 0.8 dB */, 1.150383 /* 0.6 dB */, 1.158999 /* 0.6 dB */, 1.154727 /* 0.6 dB */, 
/*  924 */  1.171862 /* 0.7 dB */, 1.131091 /* 0.5 dB */, 1.221929 /* 0.9 dB */, 1.286926 /* 1.1 dB */, 
/*  928 */  1.185488 /* 0.7 dB */, 1.200440 /* 0.8 dB */, 1.133214 /* 0.5 dB */, 1.182988 /* 0.7 dB */, 
/*  932 */  1.100000 /* 0.4 dB */, 1.079444 /* 0.3 dB */, 1.115933 /* 0.5 dB */, 1.146251 /* 0.6 dB */, 
/*  936 */  1.149641 /* 0.6 dB */, 1.103125 /* 0.4 dB */, 1.167697 /* 0.7 dB */, 1.100564 /* 0.4 dB */, 
/*  940 */  1.187585 /* 0.7 dB */, 1.134163 /* 0.5 dB */, 1.149726 /* 0.6 dB */, 1.102796 /* 0.4 dB */, 
/*  944 */  1.045135 /* 0.2 dB */, 1.141160 /* 0.6 dB */, 1.182642 /* 0.7 dB */, 1.197851 /* 0.8 dB */, 
/*  948 */  1.133621 /* 0.5 dB */, 1.219881 /* 0.9 dB */, 1.136309 /* 0.6 dB */, 1.113707 /* 0.5 dB */, 
/*  952 */  1.144708 /* 0.6 dB */, 1.161116 /* 0.6 dB */, 1.117813 /* 0.5 dB */, 1.086901 /* 0.4 dB */, 
/*  956 */  1.161172 /* 0.6 dB */, 1.173180 /* 0.7 dB */, 1.087128 /* 0.4 dB */, 1.174546 /* 0.7 dB */, 
/*  960 */  1.122405 /* 0.5 dB */, 1.072006 /* 0.3 dB */, 1.095083 /* 0.4 dB */, 1.082864 /* 0.3 dB */, 
/*  964 */  1.055644 /* 0.2 dB */, 1.113482 /* 0.5 dB */, 1.134959 /* 0.5 dB */, 1.131108 /* 0.5 dB */, 
/*  968 */  1.121279 /* 0.5 dB */, 1.082905 /* 0.3 dB */, 1.082238 /* 0.3 dB */, 1.053345 /* 0.2 dB */, 
/*  972 */  1.127936 /* 0.5 dB */, 1.095000 /* 0.4 dB */, 1.083976 /* 0.4 dB */, 1.095168 /* 0.4 dB */, 
/*  976 */  1.143136 /* 0.6 dB */, 1.144652 /* 0.6 dB */, 1.093722 /* 0.4 dB */, 1.157797 /* 0.6 dB */, 
/*  980 */  1.093239 /* 0.4 dB */, 1.084164 /* 0.4 dB */, 1.081985 /* 0.3 dB */, 1.151785 /* 0.6 dB */, 
/*  984 */  1.141417 /* 0.6 dB */, 1.101173 /* 0.4 dB */, 1.078210 /* 0.3 dB */, 1.042725 /* 0.2 dB */, 
/*  988 */  1.075250 /* 0.3 dB */, 1.088564 /* 0.4 dB */, 1.058303 /* 0.2 dB */, 1.082009 /* 0.3 dB */, 
/*  992 */  1.136392 /* 0.6 dB */, 1.146566 /* 0.6 dB */, 1.000000 /* 0.0 dB */, 1.032547 /* 0.1 dB */, 
/*  996 */  1.097960 /* 0.4 dB */, 1.118410 /* 0.5 dB */, 1.064715 /* 0.3 dB */, 1.048058 /* 0.2 dB */, 
/* 1000 */  1.105054 /* 0.4 dB */, 1.150549 /* 0.6 dB */, 1.045090 /* 0.2 dB */, 1.113806 /* 0.5 dB */, 
/* 1004 */  1.044794 /* 0.2 dB */, 1.058921 /* 0.2 dB */, 1.123009 /* 0.5 dB */, 1.143030 /* 0.6 dB */, 
/* 1008 */  1.144095 /* 0.6 dB */, 1.154337 /* 0.6 dB */, 1.043447 /* 0.2 dB */, 1.064889 /* 0.3 dB */, 
/* 1012 */  1.133337 /* 0.5 dB */, 1.103734 /* 0.4 dB */, 1.112923 /* 0.5 dB */, 1.088887 /* 0.4 dB */, 
/* 1016 */  1.074361 /* 0.3 dB */, 1.046387 /* 0.2 dB */, 1.095039 /* 0.4 dB */, 1.118828 /* 0.5 dB */, 
/* 1020 */  1.056148 /* 0.2 dB */, 1.042588 /* 0.2 dB */, 1.077248 /* 0.3 dB */, 1.090134 /* 0.4 dB */, 
};

#endif // FASTFIR_H
